<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>spyrit.misc package &mdash; spyrit 1.0.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="spyrit.pre_processing package" href="spyrit.pre_processing.html" />
    <link rel="prev" title="spyrit.learning package" href="spyrit.learning.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> spyrit
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="modules.html">spyrit</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="spyrit.html">spyrit package</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="spyrit.html#subpackages">Subpackages</a></li>
<li class="toctree-l4"><a class="reference internal" href="spyrit.html#module-spyrit">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">spyrit</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../api.html">API reference</a> &raquo;</li>
          <li><a href="modules.html">spyrit</a> &raquo;</li>
          <li><a href="spyrit.html">spyrit package</a> &raquo;</li>
      <li>spyrit.misc package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/spyrit.misc.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="spyrit-misc-package">
<h1>spyrit.misc package<a class="headerlink" href="#spyrit-misc-package" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-spyrit.misc.data_visualisation">
<span id="spyrit-misc-data-visualisation-module"></span><h2>spyrit.misc.data_visualisation module<a class="headerlink" href="#module-spyrit.misc.data_visualisation" title="Permalink to this heading"></a></h2>
<p>Created on Thu Jan 16 08:56:13 2020</p>
<p>&#64;author: crombez</p>
<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.data_visualisation.plot_im2D">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.data_visualisation.</span></span><span class="sig-name descname"><span class="pre">plot_im2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Im</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'viridis'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/data_visualisation.html#plot_im2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.data_visualisation.plot_im2D" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.data_visualisation.show_image_and_infos">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.data_visualisation.</span></span><span class="sig-name descname"><span class="pre">show_image_and_infos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/data_visualisation.html#show_image_and_infos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.data_visualisation.show_image_and_infos" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.data_visualisation.show_images_infos">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.data_visualisation.</span></span><span class="sig-name descname"><span class="pre">show_images_infos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/data_visualisation.html#show_images_infos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.data_visualisation.show_images_infos" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.data_visualisation.simple_plot_2D">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.data_visualisation.</span></span><span class="sig-name descname"><span class="pre">simple_plot_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Lx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ly</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">style_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'b'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/data_visualisation.html#simple_plot_2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.data_visualisation.simple_plot_2D" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-spyrit.misc.disp">
<span id="spyrit-misc-disp-module"></span><h2>spyrit.misc.disp module<a class="headerlink" href="#module-spyrit.misc.disp" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.disp.Multi_plots">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.disp.</span></span><span class="sig-name descname"><span class="pre">Multi_plots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suptitle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">matplotlib.pyplot.cm.gray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis_off</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aspect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(16,</span> <span class="pre">9)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">14</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/disp.html#Multi_plots"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.disp.Multi_plots" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.disp.compare_video_frames">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.disp.</span></span><span class="sig-name descname"><span class="pre">compare_video_frames</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vid_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_disp_frames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suptitle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">matplotlib.pyplot.cm.gray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aspect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(16,</span> <span class="pre">9)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">14</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/disp.html#compare_video_frames"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.disp.compare_video_frames" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.disp.display_rgb_vid">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.disp.</span></span><span class="sig-name descname"><span class="pre">display_rgb_vid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">video</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/disp.html#display_rgb_vid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.disp.display_rgb_vid" title="Permalink to this definition"></a></dt>
<dd><p>video is a numpy array of shape [nb_frames, 3, nx, ny]</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.disp.display_vid">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.disp.</span></span><span class="sig-name descname"><span class="pre">display_vid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">video</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">matplotlib.pyplot.cm.gray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/disp.html#display_vid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.disp.display_vid" title="Permalink to this definition"></a></dt>
<dd><p>video is a numpy array of shape [nb_frames, 1, nx, ny]</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.disp.fitPlots">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.disp.</span></span><span class="sig-name descname"><span class="pre">fitPlots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aspect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(16,</span> <span class="pre">9)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/disp.html#fitPlots"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.disp.fitPlots" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.disp.histogram">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.disp.</span></span><span class="sig-name descname"><span class="pre">histogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/disp.html#histogram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.disp.histogram" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.disp.imagecomp">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.disp.</span></span><span class="sig-name descname"><span class="pre">imagecomp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Img1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Img2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suptitle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">matplotlib.pyplot.cm.gray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">matplotlib.pyplot.cm.gray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/disp.html#imagecomp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.disp.imagecomp" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.disp.imagepanel">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.disp.</span></span><span class="sig-name descname"><span class="pre">imagepanel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Img1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Img2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Img3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Img4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suptitle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title4</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">matplotlib.pyplot.cm.gray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">matplotlib.pyplot.cm.gray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">matplotlib.pyplot.cm.gray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap4</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">matplotlib.pyplot.cm.gray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/disp.html#imagepanel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.disp.imagepanel" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.disp.imagesc">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.disp.</span></span><span class="sig-name descname"><span class="pre">imagesc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">matplotlib.pyplot.cm.gray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/disp.html#imagesc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.disp.imagesc" title="Permalink to this definition"></a></dt>
<dd><p>imagesc(IMG) Display image Img with scaled colors with greyscale
colormap and colorbar
imagesc(IMG, title=ttl) Display image Img with scaled colors with
greyscale colormap and colorbar, with the title ttl
imagesc(IMG, title=ttl, colormap=cmap) Display image Img with scaled colors
with colormap and colorbar specified by cmap (choose between ‘plasma’,
‘jet’, and ‘grey’), with the title ttl</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.disp.plot">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.disp.</span></span><span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'black'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/disp.html#plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.disp.plot" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.disp.pre_process_video">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.disp.</span></span><span class="sig-name descname"><span class="pre">pre_process_video</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">video</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop_patch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/disp.html#pre_process_video"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.disp.pre_process_video" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.disp.print_mean_std">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.disp.</span></span><span class="sig-name descname"><span class="pre">print_mean_std</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/disp.html#print_mean_std"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.disp.print_mean_std" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.disp.string_mean_std">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.disp.</span></span><span class="sig-name descname"><span class="pre">string_mean_std</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/disp.html#string_mean_std"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.disp.string_mean_std" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.disp.torch2numpy">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.disp.</span></span><span class="sig-name descname"><span class="pre">torch2numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">torch_tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/disp.html#torch2numpy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.disp.torch2numpy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.disp.uint8">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.disp.</span></span><span class="sig-name descname"><span class="pre">uint8</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dsp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/disp.html#uint8"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.disp.uint8" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.disp.vid2batch">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.disp.</span></span><span class="sig-name descname"><span class="pre">vid2batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_frame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_frame</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/disp.html#vid2batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.disp.vid2batch" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-spyrit.misc.examples">
<span id="spyrit-misc-examples-module"></span><h2>spyrit.misc.examples module<a class="headerlink" href="#module-spyrit.misc.examples" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.examples.circle">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.examples.</span></span><span class="sig-name descname"><span class="pre">circle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_max</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/examples.html#circle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.examples.circle" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.examples.permutation_matrix">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.examples.</span></span><span class="sig-name descname"><span class="pre">permutation_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/examples.html#permutation_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.examples.permutation_matrix" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.examples.translation_matrix">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.examples.</span></span><span class="sig-name descname"><span class="pre">translation_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_pixels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/examples.html#translation_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.examples.translation_matrix" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-spyrit.misc.matrix_tools">
<span id="spyrit-misc-matrix-tools-module"></span><h2>spyrit.misc.matrix_tools module<a class="headerlink" href="#module-spyrit.misc.matrix_tools" title="Permalink to this heading"></a></h2>
<p>Created on Wed Jan 15 16:37:27 2020</p>
<p>&#64;author: crombez</p>
<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.matrix_tools.Sum_coll">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.matrix_tools.</span></span><span class="sig-name descname"><span class="pre">Sum_coll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_lin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_coll</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/matrix_tools.html#Sum_coll"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.matrix_tools.Sum_coll" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.matrix_tools.clean_out">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.matrix_tools.</span></span><span class="sig-name descname"><span class="pre">clean_out</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/matrix_tools.html#clean_out"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.matrix_tools.clean_out" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.matrix_tools.compression_1D">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.matrix_tools.</span></span><span class="sig-name descname"><span class="pre">compression_1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/matrix_tools.html#compression_1D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.matrix_tools.compression_1D" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.matrix_tools.data_conv_hadamard">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.matrix_tools.</span></span><span class="sig-name descname"><span class="pre">data_conv_hadamard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/matrix_tools.html#data_conv_hadamard"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.matrix_tools.data_conv_hadamard" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.matrix_tools.expend_vect">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.matrix_tools.</span></span><span class="sig-name descname"><span class="pre">expend_vect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Vect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/matrix_tools.html#expend_vect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.matrix_tools.expend_vect" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.matrix_tools.normalize_by_median_mat_2D">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.matrix_tools.</span></span><span class="sig-name descname"><span class="pre">normalize_by_median_mat_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/matrix_tools.html#normalize_by_median_mat_2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.matrix_tools.normalize_by_median_mat_2D" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.matrix_tools.normalize_mat_2D">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.matrix_tools.</span></span><span class="sig-name descname"><span class="pre">normalize_mat_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/matrix_tools.html#normalize_mat_2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.matrix_tools.normalize_mat_2D" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.matrix_tools.reject_outliers">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.matrix_tools.</span></span><span class="sig-name descname"><span class="pre">reject_outliers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/matrix_tools.html#reject_outliers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.matrix_tools.reject_outliers" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.matrix_tools.remove_offset_mat_2D">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.matrix_tools.</span></span><span class="sig-name descname"><span class="pre">remove_offset_mat_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/matrix_tools.html#remove_offset_mat_2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.matrix_tools.remove_offset_mat_2D" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.matrix_tools.resize">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.matrix_tools.</span></span><span class="sig-name descname"><span class="pre">resize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/matrix_tools.html#resize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.matrix_tools.resize" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.matrix_tools.smooth">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.matrix_tools.</span></span><span class="sig-name descname"><span class="pre">smooth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_pts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/matrix_tools.html#smooth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.matrix_tools.smooth" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.matrix_tools.stack_depth_matrice">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.matrix_tools.</span></span><span class="sig-name descname"><span class="pre">stack_depth_matrice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nd</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/matrix_tools.html#stack_depth_matrice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.matrix_tools.stack_depth_matrice" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-spyrit.misc.metrics">
<span id="spyrit-misc-metrics-module"></span><h2>spyrit.misc.metrics module<a class="headerlink" href="#module-spyrit.misc.metrics" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.metrics.batch_psnr">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.metrics.</span></span><span class="sig-name descname"><span class="pre">batch_psnr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">torch_batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_batch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/metrics.html#batch_psnr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.metrics.batch_psnr" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.metrics.batch_psnr_vid">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.metrics.</span></span><span class="sig-name descname"><span class="pre">batch_psnr_vid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_batch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/metrics.html#batch_psnr_vid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.metrics.batch_psnr_vid" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.metrics.batch_ssim">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.metrics.</span></span><span class="sig-name descname"><span class="pre">batch_ssim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">torch_batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_batch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/metrics.html#batch_ssim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.metrics.batch_ssim" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.metrics.batch_ssim_vid">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.metrics.</span></span><span class="sig-name descname"><span class="pre">batch_ssim_vid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_batch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/metrics.html#batch_ssim_vid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.metrics.batch_ssim_vid" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.metrics.compare_nets_unsupervised">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.metrics.</span></span><span class="sig-name descname"><span class="pre">compare_nets_unsupervised</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">net_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">testloader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/metrics.html#compare_nets_unsupervised"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.metrics.compare_nets_unsupervised" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.metrics.compare_video_nets_supervised">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.metrics.</span></span><span class="sig-name descname"><span class="pre">compare_video_nets_supervised</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">net_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">testloader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/metrics.html#compare_video_nets_supervised"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.metrics.compare_video_nets_supervised" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.metrics.dataset_meas">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.metrics.</span></span><span class="sig-name descname"><span class="pre">dataset_meas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/metrics.html#dataset_meas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.metrics.dataset_meas" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.metrics.dataset_psnr">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.metrics.</span></span><span class="sig-name descname"><span class="pre">dataset_psnr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/metrics.html#dataset_psnr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.metrics.dataset_psnr" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.metrics.dataset_psnr_ssim">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.metrics.</span></span><span class="sig-name descname"><span class="pre">dataset_psnr_ssim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/metrics.html#dataset_psnr_ssim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.metrics.dataset_psnr_ssim" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.metrics.dataset_psnr_ssim_fcl">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.metrics.</span></span><span class="sig-name descname"><span class="pre">dataset_psnr_ssim_fcl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/metrics.html#dataset_psnr_ssim_fcl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.metrics.dataset_psnr_ssim_fcl" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.metrics.dataset_ssim">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.metrics.</span></span><span class="sig-name descname"><span class="pre">dataset_ssim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/metrics.html#dataset_ssim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.metrics.dataset_ssim" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.metrics.print_mean_std">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.metrics.</span></span><span class="sig-name descname"><span class="pre">print_mean_std</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/metrics.html#print_mean_std"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.metrics.print_mean_std" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.metrics.psnr">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.metrics.</span></span><span class="sig-name descname"><span class="pre">psnr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">I1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">I2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/metrics.html#psnr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.metrics.psnr" title="Permalink to this definition"></a></dt>
<dd><p>Computes the psnr between two images I1 and I2</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.metrics.psnr_">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.metrics.</span></span><span class="sig-name descname"><span class="pre">psnr_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/metrics.html#psnr_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.metrics.psnr_" title="Permalink to this definition"></a></dt>
<dd><p>Computes the psnr between two image with values expected in a given range</p>
<dl class="simple">
<dt>Args:</dt><dd><p>img1, img2 (np.ndarray): images
r (float): image range</p>
</dd>
<dt>Returns:</dt><dd><p>Psnr (float): Peak signal-to-noise ratio</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.metrics.ssim">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.metrics.</span></span><span class="sig-name descname"><span class="pre">ssim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">I1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">I2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/metrics.html#ssim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.metrics.ssim" title="Permalink to this definition"></a></dt>
<dd><p>Computes the ssim between two images I1 and I2</p>
</dd></dl>

</section>
<section id="module-spyrit.misc.pattern_choice">
<span id="spyrit-misc-pattern-choice-module"></span><h2>spyrit.misc.pattern_choice module<a class="headerlink" href="#module-spyrit.misc.pattern_choice" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="spyrit.misc.pattern_choice.Basis_patterns">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">spyrit.misc.pattern_choice.</span></span><span class="sig-name descname"><span class="pre">Basis_patterns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'split'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binarized</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/pattern_choice.html#Basis_patterns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.pattern_choice.Basis_patterns" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#spyrit.misc.pattern_choice.Patterns" title="spyrit.misc.pattern_choice.Patterns"><code class="xref py py-class docutils literal notranslate"><span class="pre">Patterns</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="spyrit.misc.pattern_choice.Basis_patterns.add_desired_pattern">
<span class="sig-name descname"><span class="pre">add_desired_pattern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">def_matrix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/pattern_choice.html#Basis_patterns.add_desired_pattern"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.pattern_choice.Basis_patterns.add_desired_pattern" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="spyrit.misc.pattern_choice.Basis_patterns.set_desired_pattern">
<span class="sig-name descname"><span class="pre">set_desired_pattern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">def_matrix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/pattern_choice.html#Basis_patterns.set_desired_pattern"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.pattern_choice.Basis_patterns.set_desired_pattern" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="spyrit.misc.pattern_choice.Custom_patterns">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">spyrit.misc.pattern_choice.</span></span><span class="sig-name descname"><span class="pre">Custom_patterns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'split'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binarized</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/pattern_choice.html#Custom_patterns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.pattern_choice.Custom_patterns" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#spyrit.misc.pattern_choice.Patterns" title="spyrit.misc.pattern_choice.Patterns"><code class="xref py py-class docutils literal notranslate"><span class="pre">Patterns</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="spyrit.misc.pattern_choice.Custom_patterns.add_desired_pattern">
<span class="sig-name descname"><span class="pre">add_desired_pattern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/pattern_choice.html#Custom_patterns.add_desired_pattern"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.pattern_choice.Custom_patterns.add_desired_pattern" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="spyrit.misc.pattern_choice.Custom_patterns.set_desired_pattern">
<span class="sig-name descname"><span class="pre">set_desired_pattern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/pattern_choice.html#Custom_patterns.set_desired_pattern"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.pattern_choice.Custom_patterns.set_desired_pattern" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.pattern_choice.Daubechies">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.pattern_choice.</span></span><span class="sig-name descname"><span class="pre">Daubechies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">def_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">par</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lvl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/pattern_choice.html#Daubechies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.pattern_choice.Daubechies" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.pattern_choice.Daubechies_opt">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.pattern_choice.</span></span><span class="sig-name descname"><span class="pre">Daubechies_opt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">par</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lvl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/pattern_choice.html#Daubechies_opt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.pattern_choice.Daubechies_opt" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.pattern_choice.Fourier">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.pattern_choice.</span></span><span class="sig-name descname"><span class="pre">Fourier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">def_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">par</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lvl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/pattern_choice.html#Fourier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.pattern_choice.Fourier" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.pattern_choice.Fourier_opt">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.pattern_choice.</span></span><span class="sig-name descname"><span class="pre">Fourier_opt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">par</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lvl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/pattern_choice.html#Fourier_opt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.pattern_choice.Fourier_opt" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.pattern_choice.Haar">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.pattern_choice.</span></span><span class="sig-name descname"><span class="pre">Haar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">def_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">par</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lvl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/pattern_choice.html#Haar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.pattern_choice.Haar" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.pattern_choice.Haar_opt">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.pattern_choice.</span></span><span class="sig-name descname"><span class="pre">Haar_opt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">par</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lvl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/pattern_choice.html#Haar_opt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.pattern_choice.Haar_opt" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.pattern_choice.Hadamard">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.pattern_choice.</span></span><span class="sig-name descname"><span class="pre">Hadamard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">def_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">par</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lvl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/pattern_choice.html#Hadamard"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.pattern_choice.Hadamard" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.pattern_choice.Hadamard_opt">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.pattern_choice.</span></span><span class="sig-name descname"><span class="pre">Hadamard_opt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">par</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lvl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/pattern_choice.html#Hadamard_opt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.pattern_choice.Hadamard_opt" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="spyrit.misc.pattern_choice.Optimized_patterns">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">spyrit.misc.pattern_choice.</span></span><span class="sig-name descname"><span class="pre">Optimized_patterns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'split'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binarized</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/pattern_choice.html#Optimized_patterns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.pattern_choice.Optimized_patterns" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#spyrit.misc.pattern_choice.Patterns" title="spyrit.misc.pattern_choice.Patterns"><code class="xref py py-class docutils literal notranslate"><span class="pre">Patterns</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="spyrit.misc.pattern_choice.Optimized_patterns.add_desired_pattern">
<span class="sig-name descname"><span class="pre">add_desired_pattern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M_prim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/pattern_choice.html#Optimized_patterns.add_desired_pattern"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.pattern_choice.Optimized_patterns.add_desired_pattern" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="spyrit.misc.pattern_choice.Optimized_patterns.set_desired_pattern">
<span class="sig-name descname"><span class="pre">set_desired_pattern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/pattern_choice.html#Optimized_patterns.set_desired_pattern"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.pattern_choice.Optimized_patterns.set_desired_pattern" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="spyrit.misc.pattern_choice.Patterns">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">spyrit.misc.pattern_choice.</span></span><span class="sig-name descname"><span class="pre">Patterns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'split'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binarized</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">par</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lvl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dyn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/pattern_choice.html#Patterns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.pattern_choice.Patterns" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="spyrit.misc.pattern_choice.Patterns.add_desired_patterns">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">add_desired_patterns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">def_matrix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/pattern_choice.html#Patterns.add_desired_patterns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.pattern_choice.Patterns.add_desired_patterns" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="spyrit.misc.pattern_choice.Patterns.get_all_desired_pattern">
<span class="sig-name descname"><span class="pre">get_all_desired_pattern</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/pattern_choice.html#Patterns.get_all_desired_pattern"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.pattern_choice.Patterns.get_all_desired_pattern" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="spyrit.misc.pattern_choice.Patterns.get_desired_pattern">
<span class="sig-name descname"><span class="pre">get_desired_pattern</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/pattern_choice.html#Patterns.get_desired_pattern"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.pattern_choice.Patterns.get_desired_pattern" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="spyrit.misc.pattern_choice.Patterns.get_measurement_matrix">
<span class="sig-name descname"><span class="pre">get_measurement_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/pattern_choice.html#Patterns.get_measurement_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.pattern_choice.Patterns.get_measurement_matrix" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="spyrit.misc.pattern_choice.Patterns.save_measurement_matrix">
<span class="sig-name descname"><span class="pre">save_measurement_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/pattern_choice.html#Patterns.save_measurement_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.pattern_choice.Patterns.save_measurement_matrix" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="spyrit.misc.pattern_choice.Patterns.set_desired_pattern">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_desired_pattern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">def_matrix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/pattern_choice.html#Patterns.set_desired_pattern"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.pattern_choice.Patterns.set_desired_pattern" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="spyrit.misc.pattern_choice.Patterns.set_measurement_matrix">
<span class="sig-name descname"><span class="pre">set_measurement_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/pattern_choice.html#Patterns.set_measurement_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.pattern_choice.Patterns.set_measurement_matrix" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.pattern_choice.matrix2conv">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.pattern_choice.</span></span><span class="sig-name descname"><span class="pre">matrix2conv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Matrix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/pattern_choice.html#matrix2conv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.pattern_choice.matrix2conv" title="Permalink to this definition"></a></dt>
<dd><p>Returns Convulution filter che each kernel correponds to a line of
Matrix, that has been reshaped</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.pattern_choice.shift">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.pattern_choice.</span></span><span class="sig-name descname"><span class="pre">shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dyn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/pattern_choice.html#shift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.pattern_choice.shift" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.pattern_choice.split">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.pattern_choice.</span></span><span class="sig-name descname"><span class="pre">split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dyn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/pattern_choice.html#split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.pattern_choice.split" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-spyrit.misc.walsh_hadamard">
<span id="spyrit-misc-walsh-hadamard-module"></span><h2>spyrit.misc.walsh_hadamard module<a class="headerlink" href="#module-spyrit.misc.walsh_hadamard" title="Permalink to this heading"></a></h2>
<p>Walsh-ordered Hadamard tranforms.</p>
<p>Longer description of this module.</p>
<p>This program is free software: you can redistribute it and/or modify it under
the terms of the GNU General Public License as published by the Free Software
Foundation, either version 3 of the License, or (at your option) any later
version.</p>
<p>This program is distributed in the hope that it will be useful, but WITHOUT
ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License along with
this program. If not, see &lt;<a class="reference external" href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>&gt;.</p>
<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.b2_to_b10">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">b2_to_b10</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#b2_to_b10"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.b2_to_b10" title="Permalink to this definition"></a></dt>
<dd><p>Convert a list of numbers in base 2 to base 10
Args:</p>
<blockquote>
<div><p>l (list[str]): base2 numbers.</p>
</div></blockquote>
<dl>
<dt>Returns:</dt><dd><p>list[int]: base10 numbers</p>
</dd>
<dt>Examples:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.bit_reverse_traverse">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">bit_reverse_traverse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#bit_reverse_traverse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.bit_reverse_traverse" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.bit_reversed_list">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">bit_reversed_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#bit_reversed_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.bit_reversed_list" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.bit_reversed_matrix">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">bit_reversed_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#bit_reversed_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.bit_reversed_matrix" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.fwalsh2_S">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">fwalsh2_S</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#fwalsh2_S"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.fwalsh2_S" title="Permalink to this definition"></a></dt>
<dd><p>Fast Walsh S-transform of X in “2D”</p>
<dl>
<dt>Args:</dt><dd><p>x (np.ndarray): n-by-n signal. n**2 should be a power of two.
ind (bool, optional): True for sequency (default)
ind (list, optional): permutation indices.</p>
</dd>
<dt>Returns:</dt><dd><p>np.ndarray: n-by-1 S-transformed signal</p>
</dd>
<dt>Examples:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh</span><span class="o">.</span><span class="n">fwalsh2_S</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.fwalsh2_S_torch">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">fwalsh2_S_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#fwalsh2_S_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.fwalsh2_S_torch" title="Permalink to this definition"></a></dt>
<dd><p>Fast Walsh S-transform of X in “2D”</p>
<dl>
<dt>Args:</dt><dd><dl class="simple">
<dt><code class="xref py py-attr docutils literal notranslate"><span class="pre">X</span></code> (torch.tensor):  input image with shape <cite>(*, n, n)</cite>. <a href="#id1"><span class="problematic" id="id2">`</span></a>n`**2</dt><dd><p>should be a power of two.</p>
</dd>
</dl>
<p><code class="xref py py-attr docutils literal notranslate"><span class="pre">ind</span></code> (bool, optional): True for sequency (default)
<code class="xref py py-attr docutils literal notranslate"><span class="pre">ind</span></code> (list, optional): permutation indices.</p>
</dd>
<dt>Returns:</dt><dd><p>torch.tensor: S-transformed signal with shape <cite>(*, n, n)</cite></p>
</dd>
<dt>Examples:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh</span><span class="o">.</span><span class="n">fwalsh2_S_torch</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example 2:</dt><dd><p>Repeating the Walsh-ordered S-transform using input indices is faster</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">timeit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">6</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwalsh2_S_torch</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">number</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No indices as inputs (10x): </span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ind</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">sequency_perm_ind</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwalsh2_S_torch</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">ind</span><span class="p">),</span> <span class="n">number</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;With indices as inputs (10x): </span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.fwalsh_G">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">fwalsh_G</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#fwalsh_G"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.fwalsh_G" title="Permalink to this definition"></a></dt>
<dd><p>Fast Walsh G-transform of x</p>
<dl>
<dt>Args:</dt><dd><p>x (np.ndarray): n-by-1 signal. n+1 should be a power of two.
ind (bool, optional): True for sequency (default)
ind (list, optional): permutation indices. This is faster than True</p>
<blockquote>
<div><p>when repeating the sequency-ordered transform
multilple times.</p>
</div></blockquote>
</dd>
<dt>Returns:</dt><dd><p>np.ndarray: n-by-1 S-transformed signal</p>
</dd>
<dt>Example 1:</dt><dd><p>Walsh-ordered G-transform of a signal of length 7</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwalsh_G</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example 2:</dt><dd><p>Permuted fast G-transform</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ind</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwalsh_G</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ind</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example 3:</dt><dd><p>Repeating the Walsh-ordered G-transform using input indices is faster</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">timeit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">12</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwalsh_G</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">number</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No indices as inputs (10x): </span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ind</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">sequency_perm_ind</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwalsh_G</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">ind</span><span class="p">),</span> <span class="n">number</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;With indices as inputs (10x): </span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example 4:</dt><dd><p>Comparison with G-transform via matrix-vector product</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y1</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwalsh_G</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y2</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">walsh_G</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Diff = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.fwalsh_G_torch">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">fwalsh_G_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#fwalsh_G_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.fwalsh_G_torch" title="Permalink to this definition"></a></dt>
<dd><p>Fast Walsh G-transform of x</p>
<dl>
<dt>Args:</dt><dd><dl class="simple">
<dt><code class="xref py py-attr docutils literal notranslate"><span class="pre">x</span></code> (torch.tensor):  input signal with shape <cite>(*, n)</cite>. <a href="#id3"><span class="problematic" id="id4">`</span></a>n`+1</dt><dd><p>should be a power of two.</p>
</dd>
</dl>
<p><code class="xref py py-attr docutils literal notranslate"><span class="pre">ind</span></code> (bool, optional): True for sequency (default)
<code class="xref py py-attr docutils literal notranslate"><span class="pre">ind</span></code> (list, optional): permutation indices. This is faster than</p>
<blockquote>
<div><p>True when repeating the sequency-ordered
transform multilple times.</p>
</div></blockquote>
</dd>
<dt>Returns:</dt><dd><p>torch.tensor: S-transformed signal with shape <cite>(*, n)</cite>.</p>
</dd>
<dt>Example 1:</dt><dd><p>Walsh-ordered G-transform of a signal of length 7</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwalsh_G_torch</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example 2:</dt><dd><p>Permuted fast G-transform</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ind</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwalsh_G_torch</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ind</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example 3:</dt><dd><p>Comparison with the numpy transform</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_np</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwalsh_G</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_torch</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_torch</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwalsh_G_torch</span><span class="p">(</span><span class="n">x_torch</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">y_np</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">y_torch</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example 3:</dt><dd><p>Repeating the Walsh-ordered G-transform using input indices is faster</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">timeit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span><span class="mi">2</span><span class="o">**</span><span class="mi">12</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwalsh_G_torch</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">number</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No indices as inputs (10x): </span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ind</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">sequency_perm_ind</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwalsh_G_torch</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">ind</span><span class="p">),</span> <span class="n">number</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;With indices as inputs (10x): </span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.fwalsh_S">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">fwalsh_S</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#fwalsh_S"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.fwalsh_S" title="Permalink to this definition"></a></dt>
<dd><p>Fast Walsh S-transform of x</p>
<dl>
<dt>Args:</dt><dd><p>x (np.ndarray): n-by-1 signal. n+1 should be a power of two.
ind (bool, optional): True for sequency (default)
ind (list, optional): permutation indices. This is faster than True</p>
<blockquote>
<div><p>when repeating the sequency-ordered transform
multilple times.</p>
</div></blockquote>
</dd>
<dt>Returns:</dt><dd><p>np.ndarray: n-by-1 S-transformed signal</p>
</dd>
<dt>Example 1:</dt><dd><p>Walsh-ordered S-transform of a signal of length 7</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwalsh_S</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example 2:</dt><dd><p>Permuted fast S-transform</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ind</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwalsh_S</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ind</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example 3:</dt><dd><p>Repeating the Walsh-ordered S-transform using input indices is faster</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">timeit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">12</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwalsh_S</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">number</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No indices as inputs (10x): </span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ind</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">sequency_perm_ind</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwalsh_S</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">ind</span><span class="p">),</span> <span class="n">number</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;With indices as inputs (10x): </span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example 4:</dt><dd><p>Comparison with S-transform via matrix-vector product</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y1</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwalsh_S</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y2</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">walsh_S</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Diff = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example 5:</dt><dd><p>Computation times for a signal of length 2**12-1</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">timeit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">14</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwalsh_S</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">number</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fast transform, no ind (10x): </span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ind</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">sequency_perm_ind</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwalsh_S</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">ind</span><span class="p">),</span> <span class="n">number</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fast transform, with ind (10x): </span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">walsh_S_matrix</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">wh</span><span class="o">.</span><span class="n">walsh_S</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">S</span><span class="p">),</span> <span class="n">number</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Naive transform (10x): </span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.fwalsh_S_torch">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">fwalsh_S_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#fwalsh_S_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.fwalsh_S_torch" title="Permalink to this definition"></a></dt>
<dd><p>Fast Walsh S-transform of x</p>
<dl>
<dt>Args:</dt><dd><dl class="simple">
<dt><code class="xref py py-attr docutils literal notranslate"><span class="pre">x</span></code> (torch.tensor):  input signal with shape <cite>(*, n)</cite>. <a href="#id5"><span class="problematic" id="id6">`</span></a>n`+1</dt><dd><p>should be a power of two.</p>
</dd>
</dl>
<p>ind (bool, optional): True for sequency (default)
ind (list, optional): permutation indices. This is faster than True</p>
<blockquote>
<div><p>when repeating the sequency-ordered transform
multilple times.</p>
</div></blockquote>
</dd>
<dt>Returns:</dt><dd><p>torch.tensor: -by-n S-transformed signal</p>
</dd>
<dt>Example 1:</dt><dd><p>Walsh-ordered S-transform of a signal of length 7</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwalsh_S_torch</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example 2:</dt><dd><p>Repeating the Walsh-ordered S-transform using input indices is faster</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">timeit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">14</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwalsh_S_torch</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">number</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No indices as inputs (10x): </span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ind</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">sequency_perm_ind</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwalsh_S_torch</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">ind</span><span class="p">),</span> <span class="n">number</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;With indices as inputs (10x): </span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.fwht">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">fwht</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#fwht"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.fwht" title="Permalink to this definition"></a></dt>
<dd><p>Fast Walsh-Hadamard transform of x</p>
<dl class="simple">
<dt>Args:</dt><dd><p>x (np.ndarray): n-by-1 input signal, where n is a power of two.
order (bool, optional): True for sequency (default), False for natural.
order (list, optional): permutation indices.</p>
</dd>
<dt>Returns:</dt><dd><p>np.ndarray: n-by-1 transformed signal</p>
</dd>
</dl>
<p>Example 1:</p>
<blockquote>
<div><p>Fast sequency-ordered (i.e., Walsh) Hadamard transform</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwht</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>Example 2:</p>
<blockquote>
<div><p>Fast Hadamard transform</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwht</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>Example 3:</p>
<blockquote>
<div><p>Permuted fast Hadamard transform</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ind</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwht</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ind</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>Example 4:</p>
<blockquote>
<div><p>Comparison with Walsh-Hadamard transform via matrix-vector product</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="kn">import</span> <span class="n">fwht</span><span class="p">,</span> <span class="n">walsh_matrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y1</span> <span class="o">=</span> <span class="n">fwht</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">walsh_matrix</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y2</span> <span class="o">=</span> <span class="n">H</span> <span class="o">@</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Diff = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>Example 5:</p>
<blockquote>
<div><p>Comparison with the fast Walsh-Hadamard transform from sympy
&gt;&gt;&gt; import spyrit.misc.walsh_hadamard as wh
&gt;&gt;&gt; import sympy as sp
&gt;&gt;&gt; x = np.array([1, 3, 0, -1, 7, 5, 1, -2])
&gt;&gt;&gt; y1 = wh.fwht(x)
&gt;&gt;&gt; y2 = sp.fwht(x)
&gt;&gt;&gt; y3 = wh.sequency_perm(np.array(y2))
&gt;&gt;&gt; print(f”Diff = {np.linalg.norm(y1-y3)}”)</p>
</div></blockquote>
<p>Example 6:</p>
<blockquote>
<div><p>Computation times for a signal of length 2**12</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">timeit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">12</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwht</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">number</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fast Walsh transform, no ind (10x): </span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ind</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">sequency_perm_ind</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwht</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">ind</span><span class="p">),</span> <span class="n">number</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fast Walsh transform, with ind (10x): </span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwht</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="kc">False</span><span class="p">),</span> <span class="n">number</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fast Hadamard transform (10x): </span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">fwht</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">number</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fast Hadamard transform from sympy (10x): </span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.fwht_torch">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">fwht_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#fwht_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.fwht_torch" title="Permalink to this definition"></a></dt>
<dd><p>Fast Walsh-Hadamard transform of x</p>
<dl>
<dt>Args:</dt><dd><p>x (np.ndarray): -by-n input signal, where n is a power of two.
order (bool, optional): True for sequency (default), False for natural.
order (list, optional): permutation indices.</p>
</dd>
<dt>Returns:</dt><dd><p>np.ndarray: n-by-1 transformed signal</p>
</dd>
<dt>Example 1:</dt><dd><p>Fast sequency-ordered (i.e., Walsh) Hadamard transform</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="kc">None</span><span class="p">,:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwht_torch</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example 2:</dt><dd><p>Fast Hadamard transform</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="kc">None</span><span class="p">,:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwht_torch</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example 3:</dt><dd><p>Permuted fast Hadamard transform</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ind</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwht_torch</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ind</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example 4:</dt><dd><p>Comparison with the numpy transform</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_np</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwht</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_torch</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_torch</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwht_torch</span><span class="p">(</span><span class="n">x_torch</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">y_np</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">y_torch</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example 5:</dt><dd><p>Computation times for a signal of length 2**12</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">timeit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">12</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwht</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="kc">False</span><span class="p">),</span> <span class="n">number</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fast Hadamard transform numpy CPU (200x): </span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_torch</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwht_torch</span><span class="p">(</span><span class="n">x_torch</span><span class="p">,</span><span class="kc">False</span><span class="p">),</span> <span class="n">number</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fast Hadamard transform pytorch CPU (200x): </span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_torch</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwht_torch</span><span class="p">(</span><span class="n">x_torch</span><span class="p">,</span><span class="kc">False</span><span class="p">),</span> <span class="n">number</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fast Hadamard transform pytorch GPU (200x): </span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example 6:</dt><dd><p>CPU vs GPU: Computation times for 512 signals of length 2**12</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">timeit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_cpu</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span><span class="mi">2</span><span class="o">**</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwht_torch</span><span class="p">(</span><span class="n">x_cpu</span><span class="p">,</span><span class="kc">False</span><span class="p">),</span> <span class="n">number</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fast Hadamard transform pytorch CPU (10x): </span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_gpu</span> <span class="o">=</span> <span class="n">x_cpu</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwht_torch</span><span class="p">(</span><span class="n">x_gpu</span><span class="p">,</span><span class="kc">False</span><span class="p">),</span> <span class="n">number</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fast Hadamard transform pytorch GPU (10x): </span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example 7:</dt><dd><p>Repeating the Walsh-ordered transform using input indices is faster</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">timeit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span><span class="mi">2</span><span class="o">**</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwht_torch</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">number</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No indices as inputs (100x): </span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ind</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">sequency_perm_ind</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwht_torch</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">ind</span><span class="p">),</span> <span class="n">number</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;With indices as inputs (100x): </span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.get_bit_reversed_list">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">get_bit_reversed_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#get_bit_reversed_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.get_bit_reversed_list" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.gray_code_list">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">gray_code_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#gray_code_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.gray_code_list" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.gray_code_permutation">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">gray_code_permutation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#gray_code_permutation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.gray_code_permutation" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.ifwalsh2_S">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">ifwalsh2_S</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#ifwalsh2_S"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.ifwalsh2_S" title="Permalink to this definition"></a></dt>
<dd><p>Inverse Fast Walsh S-transform of Y in “2D”</p>
<blockquote>
<div><dl>
<dt>Args:</dt><dd><p>Y (np.ndarray): n-by-n signal. n**2 should be a power of two.
ind (bool, optional): True for sequency (default)
ind (list, optional): permutation indices.</p>
</dd>
<dt>Returns:</dt><dd><p>np.ndarray: n-by-1 S-transformed signal</p>
</dd>
<dt>Examples:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;image:</span>
</pre></div>
</div>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>{X}”)</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwalsh2_S</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;s-transform:</span>
</pre></div>
</div>
</dd>
<dt>{Y}”)</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Z</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">ifwalsh2_S</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;inverse s-transform:</span>
</pre></div>
</div>
</dd>
</dl>
<p>{Z}”)</p>
<blockquote>
<div><p>Note that the first pixel is not meaningful and arbitrily set to 0.</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.ifwalsh_S">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">ifwalsh_S</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#ifwalsh_S"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.ifwalsh_S" title="Permalink to this definition"></a></dt>
<dd><p>Inverse fast Walsh S-transform of s</p>
<dl>
<dt>Args:</dt><dd><p>x (np.ndarray): n-by-1 signal. n+1 should be a power of two.
ind (bool, optional): True for sequency (default).
ind (list, optional): permutation indices. This is faster than True</p>
<blockquote>
<div><p>when repeating the sequency-ordered transform
multilple times.</p>
</div></blockquote>
</dd>
<dt>Returns:</dt><dd><p>np.ndarray: n-by-1 inverse transformed signal</p>
</dd>
<dt>Examples:</dt><dd><p>Inverse S-transform of a 15-by-1 signal</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;signal: </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">fwalsh_S</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;s-transform: </span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">ifwalsh_S</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;inverse s-transform: </span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.iwalsh2">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">iwalsh2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#iwalsh2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.iwalsh2" title="Permalink to this definition"></a></dt>
<dd><p>Return 2D inverse Walsh-ordered Hadamard transform of an image</p>
<dl class="simple">
<dt>Args:</dt><dd><p>X (np.ndarray): Image as a 2D array. The image is square and its size is a power of two.
H (np.ndarray, optional): 1D inverse Walsh-ordered Hadamard transformation matrix</p>
</dd>
<dt>Returns:</dt><dd><p>np.ndarray: Inverse Hadamard transformed image as a 2D array.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.iwalsh2_S">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">iwalsh2_S</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#iwalsh2_S"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.iwalsh2_S" title="Permalink to this definition"></a></dt>
<dd><p>Inverse Fast Walsh S-transform of Y in “2D”</p>
<blockquote>
<div><dl>
<dt>Args:</dt><dd><p>Y (np.ndarray): n-by-n signal. n**2 should be a power of two.
T (np.ndarray): Inverse S-matrix</p>
</dd>
<dt>Returns:</dt><dd><p>np.ndarray: n-by-1 S-transformed signal</p>
</dd>
<dt>Examples:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;image:</span>
</pre></div>
</div>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>{X}”)</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">walsh2_S</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;s-transform:</span>
</pre></div>
</div>
</dd>
<dt>{Y}”)</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Z</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">iwalsh2_S</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;inverse s-transform:</span>
</pre></div>
</div>
</dd>
</dl>
<p>{Z}”)</p>
<blockquote>
<div><p>Note that the first pixel is not meaningful and arbitrily set to 0.</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.iwalsh_S">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">iwalsh_S</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#iwalsh_S"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.iwalsh_S" title="Permalink to this definition"></a></dt>
<dd><p>Return the inverse Walsh S-transform of s</p>
<dl>
<dt>Args:</dt><dd><p>x (np.ndarray): n-by-1 signal. n+1 should be a power of two.</p>
</dd>
<dt>Returns:</dt><dd><p>np.ndarray: n-by-1 inverse transformed signal</p>
</dd>
<dt>Examples:</dt><dd><p>Inverse S-transform of a 4095-by-1 signal</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4095</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">walsh_S</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">iwalsh_S</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">y</span><span class="o">/</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Error: </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.iwalsh_S_matrix">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">iwalsh_S_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#iwalsh_S_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.iwalsh_S_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Return inverse Walsh S-matrix of order n</p>
<dl>
<dt>Args:</dt><dd><p>n (int): Matrix order. n+1 should be a power of two.</p>
</dd>
<dt>Returns:</dt><dd><p>np.ndarray: n-by-n array</p>
</dd>
<dt>Example 1:</dt><dd><p>Inverse of the Walsh S-matrix of order 7</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">iwalsh_S_matrix</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
</pre></div>
</div>
</dd>
<dt>Example 2:</dt><dd><p>Check the inverse of the Walsh S-matrix of order 7
&gt;&gt;&gt; print(iwalsh_S_matrix(7) &#64; walsh_S_matrix(7))</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.perm_matrix_from_ind">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">perm_matrix_from_ind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#perm_matrix_from_ind"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.perm_matrix_from_ind" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.sequency_perm">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">sequency_perm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#sequency_perm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.sequency_perm" title="Permalink to this definition"></a></dt>
<dd><p>Permute the rows of a matrix to get sequency order
Args:</p>
<blockquote>
<div><p>X (np.ndarray): n-by-m input matrix
ind : index list of length n</p>
</div></blockquote>
<dl>
<dt>Returns:</dt><dd><p>np.ndarray: n-by-m input matrix</p>
</dd>
<dt>Examples:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.sequency_perm_ind">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">sequency_perm_ind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#sequency_perm_ind"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.sequency_perm_ind" title="Permalink to this definition"></a></dt>
<dd><p>Return permutation indices to get sequency from the natural order</p>
<dl>
<dt>Args:</dt><dd><p>n (int): Order of the matrix, a power of two.</p>
</dd>
<dt>Returns:</dt><dd><p>list:</p>
</dd>
<dt>Examples:</dt><dd><p>Permutation indices to get a Walsh matrix of order 8</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sequency_perm_ind</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.sequency_perm_matrix">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">sequency_perm_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#sequency_perm_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.sequency_perm_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Return permutation matrix to get sequency from the natural order
Args:</p>
<blockquote>
<div><p>n (int): Order of the matrix, a power of two.</p>
</div></blockquote>
<dl>
<dt>Returns:</dt><dd><p>np.ndarray: A n-by-n permutation matrix</p>
</dd>
<dt>Examples:</dt><dd><p>Permutation matrix of order 8</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sequency_perm_matrix</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.sequency_perm_torch">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">sequency_perm_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#sequency_perm_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.sequency_perm_torch" title="Permalink to this definition"></a></dt>
<dd><p>Permute the last dimension of a tensor to get sequency order
Args:</p>
<blockquote>
<div><p>X (torch.tensor): -by-n input matrix
ind : index list of length n</p>
</div></blockquote>
<dl>
<dt>Returns:</dt><dd><p>torch.tensor: -by-n input matrix</p>
</dd>
<dt>Example :</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">sequency_perm_torch</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.walsh2">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">walsh2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#walsh2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.walsh2" title="Permalink to this definition"></a></dt>
<dd><p>Return 2D Walsh-ordered Hadamard transform of an image <span class="math notranslate nohighlight">\(H^\top X H\)</span></p>
<dl class="simple">
<dt>Args:</dt><dd><p>X (np.ndarray): image as a 2d array. The size is a power of two.
H (np.ndarray, optional): 1D Walsh-ordered Hadamard transformation matrix</p>
</dd>
<dt>Returns:</dt><dd><p>np.ndarray: Hadamard transformed image as a 2D array.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.walsh2_S">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">walsh2_S</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#walsh2_S"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.walsh2_S" title="Permalink to this definition"></a></dt>
<dd><p>Fast Walsh S-transform of X in “2D”</p>
<dl>
<dt>Args:</dt><dd><p>x (np.ndarray): n-by-n signal. n**2 should be a power of two.
ind (bool, optional): True for sequency (default)
ind (list, optional): permutation indices.</p>
</dd>
<dt>Returns:</dt><dd><p>np.ndarray: n-by-1 S-transformed signal</p>
</dd>
<dt>Examples:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh</span><span class="o">.</span><span class="n">walsh2_S</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.walsh2_S_fold">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">walsh2_S_fold</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#walsh2_S_fold"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.walsh2_S_fold" title="Permalink to this definition"></a></dt>
<dd><p>Fold a signal to get a “2d” s-transformed representation</p>
<p>Note: the top left (first) pixel is arbitrarily set to zero</p>
<dl>
<dt>Args:</dt><dd><dl class="simple">
<dt>x (np.ndarray): N-by- vector. N is such that N+1 = n*n, where n is a</dt><dd><p>power of two. N = 2**(2b) - 1, where b is an integer</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>X (np.ndarray): n-by-n matrix</p>
</dd>
<dt>Example 1:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">walsh2_S_matrix</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">walsh2_S_fold</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="mi">2</span><span class="p">,:])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.walsh2_S_fold_torch">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">walsh2_S_fold_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#walsh2_S_fold_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.walsh2_S_fold_torch" title="Permalink to this definition"></a></dt>
<dd><p>Fold a signal to get a “2d” s-transformed representation</p>
<p>Note: the top left (first) pixel is arbitrarily set to zero</p>
<dl>
<dt>Args:</dt><dd><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">x</span></code> (torch.tensor): input signal with shape <cite>(*, n)</cite>. n is
such that n+1 = N*N, where N is a power of two. n = 2**(2b) - 1,
where b is an integer.</p>
</dd>
<dt>Returns:</dt><dd><p>torch.tensor: output matrix with shape <cite>(*, N, N)</cite></p>
</dd>
<dt>Example 1:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">walsh2_S_matrix</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">,:])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">walsh2_S_fold_torch</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.walsh2_S_matrix">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">walsh2_S_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#walsh2_S_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.walsh2_S_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Return Walsh S-matrix in “2d”</p>
<dl>
<dt>Args:</dt><dd><p>n (int): Order of the matrix. n must be a power of two.</p>
</dd>
<dt>Returns:</dt><dd><p>S (np.ndarray): (n*n-1)-by-(n*n-1) matrix</p>
</dd>
<dt>Example 1:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">S</span> <span class="o">=</span> <span class="n">walsh2_S_matrix</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.walsh2_S_unfold">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">walsh2_S_unfold</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#walsh2_S_unfold"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.walsh2_S_unfold" title="Permalink to this definition"></a></dt>
<dd><p>Unfold a signal from a “2d” s-transformed representation</p>
<p>Note: the top left (first) pixel is arbitrarily set to zero</p>
<dl>
<dt>Args:</dt><dd><p>X (np.ndarray): n-by-m image.</p>
</dd>
<dt>Returns:</dt><dd><p>X (np.ndarray): (n*n-1)-by-1 signal</p>
</dd>
<dt>Example 1:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh</span><span class="o">.</span><span class="n">walsh2_S_unfold</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.walsh2_S_unfold_torch">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">walsh2_S_unfold_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#walsh2_S_unfold_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.walsh2_S_unfold_torch" title="Permalink to this definition"></a></dt>
<dd><p>Unfold a signal from a “2d” s-transformed representation</p>
<p>Note: Return a view of X</p>
<dl>
<dt>Args:</dt><dd><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">X</span></code> (torch.tensor): input image with shape <cite>(*, n,n)</cite>.</p>
</dd>
<dt>Returns:</dt><dd><p>output signal with shape <cite>(*, n*n-1)</cite></p>
</dd>
<dt>Example 1:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">walsh2_S_unfold_torch</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example 2:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spyrit.misc.walsh_hadamard</span> <span class="k">as</span> <span class="nn">wh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">walsh2_S_unfold_torch</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.walsh2_matrix">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">walsh2_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#walsh2_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.walsh2_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Return Walsh-ordered Hadamard matrix in 2D</p>
<dl class="simple">
<dt>Args:</dt><dd><p>n (int): Order of the matrix, which must be a power of two.</p>
</dd>
<dt>Returns:</dt><dd><p>H (np.ndarray): A n*n-by-n*n matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.walsh2_torch">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">walsh2_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#walsh2_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.walsh2_torch" title="Permalink to this definition"></a></dt>
<dd><p>Return 2D Walsh-ordered Hadamard transform of an image</p>
<dl>
<dt>Args:</dt><dd><p>im (torch.Tensor): Image, typically a B-by-C-by-W-by-H Tensor
H (torch.Tensor, optional): 1D Walsh-ordered Hadamard transformation matrix. A 2-D tensor of size W-by-H.</p>
</dd>
<dt>Returns:</dt><dd><p>torch.Tensor: Hadamard transformed image. Same size as im</p>
</dd>
<dt>Examples:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">had</span> <span class="o">=</span> <span class="n">walsh2_torch</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.walsh_G">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">walsh_G</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#walsh_G"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.walsh_G" title="Permalink to this definition"></a></dt>
<dd><p>Return the Walsh S-transform of x</p>
<dl>
<dt>Args:</dt><dd><p>x (np.ndarray): n-by-1 signal. n+1 should be a power of two.</p>
</dd>
<dt>Returns:</dt><dd><p>np.ndarray: n-by-1 S-transformed signal</p>
</dd>
<dt>Examples:</dt><dd><p>Walsh-ordered S-transform of a 15-by-1 signal</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">walsh_S</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.walsh_G_matrix">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">walsh_G_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#walsh_G_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.walsh_G_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Return Walsh-ordered Hadamard S-matrix of order n</p>
<dl>
<dt>Args:</dt><dd><p>n (int): Matrix order. n+1 should be a power of two.
H (np.ndarray, optional):</p>
</dd>
<dt>Returns:</dt><dd><p>np.ndarray: n-by-n array</p>
</dd>
<dt>Examples:</dt><dd><p>Walsh-ordered Hadamard G-matrix of order 7</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">walsh_G_matrix</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.walsh_S">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">walsh_S</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#walsh_S"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.walsh_S" title="Permalink to this definition"></a></dt>
<dd><p>Return the Walsh S-transform of x</p>
<dl>
<dt>Args:</dt><dd><p>x (np.ndarray): n-by-1 signal. n+1 should be a power of two.</p>
</dd>
<dt>Returns:</dt><dd><p>np.ndarray: n-by-1 S-transformed signal</p>
</dd>
<dt>Examples:</dt><dd><p>Walsh-ordered S-transform of a 15-by-1 signal</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">walsh_S</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.walsh_S_matrix">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">walsh_S_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#walsh_S_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.walsh_S_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Return Walsh S-matrix of order n</p>
<dl>
<dt>Args:</dt><dd><p>n (int): Matrix order. n+1 should be a power of two.</p>
</dd>
<dt>Returns:</dt><dd><p>np.ndarray: n-by-n array</p>
</dd>
<dt>Examples:</dt><dd><p>Walsh-ordered Hadamard S-matrix of order 7</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">walsh_S_matrix</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spyrit.misc.walsh_hadamard.walsh_matrix">
<span class="sig-prename descclassname"><span class="pre">spyrit.misc.walsh_hadamard.</span></span><span class="sig-name descname"><span class="pre">walsh_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spyrit/misc/walsh_hadamard.html#walsh_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spyrit.misc.walsh_hadamard.walsh_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Return 1D Walsh-ordered Hadamard transform matrix</p>
<dl>
<dt>Args:</dt><dd><p>n (int): Order of the matrix, a power of two.</p>
</dd>
<dt>Returns:</dt><dd><p>np.ndarray: A n-by-n array</p>
</dd>
<dt>Examples:</dt><dd><p>Walsh-ordered Hadamard matrix of order 8</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">walsh_matrix</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-spyrit.misc">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-spyrit.misc" title="Permalink to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="spyrit.learning.html" class="btn btn-neutral float-left" title="spyrit.learning package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="spyrit.pre_processing.html" class="btn btn-neutral float-right" title="spyrit.pre_processing package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Antonio Tomas Lorente Mur - Nicolas Ducros - Sebastien Crombez - Thomas Baudier.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>